<div class="container">
    <div class="headers">
        Reisekosten
    </div>
    <div class="bodies">
        <div class="px-4 md:px-6 lg:px-8">
            <p-tabView>
                <p-tabPanel header="Reisekosten">
                    <div class="surface-card shadow-2 p-3 border-round">
                        <form [formGroup]="myTravelForm">
                            <div class="grid">
                                <div class="col-6">
                                    <div class="field">
                                        <label>Datum</label>
                                        <p-calendar formControlName="dateRange" selectionMode="range" [readonlyInput]="false"
                                            dateFormat="dd.mm.yy" [stepMinute]=15 [showTime]="true" hourFormat="24"
                                            class="text-base text-900 flex surface-overlay surface-border"
                                            [style]="{'width':'100%', 'height': '2.3rem', 'font-family': 'Rajdhani'}"></p-calendar>
                                    </div>
                                    <div class="field">
                                        <label>Kunde</label>
                                        <p-dropdown formControlName="customer" [options]="customers" optionLabel="name"
                                            class="text-base text-900 flex surface-overlay surface-border"
                                            [style]="{'width':'100%', 'height': '2.3rem', 'font-family': 'Rajdhani'}"></p-dropdown>
                                    </div>
                                    <div class="field">
                                        <label>Zweck</label>
                                        <p-dropdown formControlName="reason" [options]="reasons"
                                            class="text-base text-900 flex surface-overlay surface-border"
                                            [style]="{'width':'100%', 'height': '2.3rem', 'font-family': 'Rajdhani'}"></p-dropdown>
                                    </div>
                                    <div class="field">
                                        <label>Kommentar</label>
                                        <textarea rows="5" cols="30" pInputTextarea formControlName="comment"
                                            class="text-base text-900 surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"></textarea>
                                    </div>
        
                                    <div class="cic-btn font-bold text-center p-4 border-round-lg" (click)="submit()">
                                        <i class="pi pi-check"></i>
                                        <span>Speichern</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div formArrayName="spends">
                                        <div *ngFor="let item of spendArray.controls; let i=index" [formGroupName]="i">
                                            <div class="grid" [style]="{'margin-bottom':'-18px'}">
                                                <div class="col-3">
                                                    <div class="field">
                                                        <label>Datum</label>
                                                        <p-calendar formControlName="date" dateFormat="dd.mm.yy" [maxDate]="maxDate" [minDate]="minDate"
                                                            class="text-base text-900 flex surface-overlay surface-border"
                                                            [style]="{'width':'100%', 'height': '2.3rem', 'font-family': 'Rajdhani'}"></p-calendar>
                                                    </div>
                                                </div>
                                                <div class="col-3">
                                                    <div class="field">
                                                        <label>Typ</label>
                                                        <p-dropdown formControlName="type" [options]="spendTyps"
                                                            class="text-base text-900 flex surface-overlay surface-border"
                                                            [style]="{'width':'100%', 'height': '2.3rem', 'font-family': 'Rajdhani'}"></p-dropdown>
                                                    </div>
                                                </div>
                                                <div class="col-2">
                                                    <div class="field">
                                                        <label>Betrag</label>
                                                        <input type="number" pInputText formControlName="value"
                                                            class="text-base text-900 surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full" />
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="flex field p-2 align-items-center h-full">
                                                        <p-button icon="fa-solid fa-plus" (click)="addSpend()" [rounded]="true"
                                                            [text]="true" severity="success "></p-button>
                                                        <p-button icon="pi pi-times" (click)="deleteSpend(i)" [rounded]="true"
                                                            [text]="true" severity="danger "></p-button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="spendArray.length == 0" class="field">
                                        <label>Ausgaben</label>
                                        <div
                                            class="flex justify-content-center text-base text-900 surface-overlay surface-border appearance-none outline-none focus:border-primary w-full">
                                            <p-button icon="fa-solid fa-plus" label="Ausgaben erfassen" (click)="addSpend()"
                                                [rounded]="true" [text]="true" severity="success "></p-button>
                                        </div>
                                    </div>
                                    <div class="border-top-1 border-300">
                                        <div class="field">
                                            <label>Belege</label>
                                        </div>
                                        <!--p-fileUpload name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php" (onUpload)="onUpload($event)" (uploadHandler)="onUpload($event)" [multiple]="true" accept="image/*" [maxFileSize]="1000000">
                                            <ng-template pTemplate="content">
                                                <ul *ngIf="uploadedFiles.length">
                                                    <li *ngFor="let file of uploadedFiles">{{ file.name }} - {{ file.size }} bytes</li>
                                                </ul>
                                            </ng-template>
                                        </p-fileUpload-->
                                        <p-fileUpload mode="basic" name="demo[]"
                                            url="https://www.primefaces.org/cdn/api/upload.php" accept="image/*"
                                            [maxFileSize]="1000000" (onUpload)="onBasicUploadAuto($event)" [auto]="true"
                                            chooseLabel="Browse"></p-fileUpload>
                                        <div *ngIf="uploadedFiles.length">
                                            <div *ngFor="let file of uploadedFiles; let i=index">
                                                    <div class="flex justify-content-around h-2rem w-full">
                                                        <div>
                                                            {{ file.name }}
                                                        </div>
                                                        <div>
                                                            {{ file.size }} bytes
                                                        </div>
                                                        <div>
                                                            <div class="flex field p-2 align-items-center h-full">
                                                                <p-button icon="pi pi-times" (click)="deleteFile(i)"
                                                                    [rounded]="true" [text]="true" severity="danger "></p-button>
                                                            </div>
                                                        </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </p-tabPanel>
                <p-tabPanel header="Alle Reisen">
                    <div class="surface-card shadow-2 p-3 border-round">
                        <div class="surface-card shadow-2 p-3 border-round">
                            <app-travel-list [data]="myTravelList"></app-travel-list>
                        </div>
                    </div>
                </p-tabPanel>
            </p-tabView>
        </div>
    </div>
</div>
<p-toast></p-toast>